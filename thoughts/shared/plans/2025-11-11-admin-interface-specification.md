# Admin Interface - Real-Time Configuration Website Specification
**Date:** 2025-11-11
**Status:** Planning - Part of Architecture Pivot
**Related:**
- [Complete Architecture Pivot](../research/2025-11-11-complete-architecture-pivot.md)
- [Guest Mode & Quality Tracking](2025-11-11-guest-mode-and-quality-tracking.md)

## Executive Summary

The **Admin Interface** is a comprehensive real-time configuration and monitoring website for Project Athena. It provides a central place to configure, monitor, and operate the entire voice assistant system with safe-apply workflows, rollback capabilities, and RBAC security.

## 1) Goals

### Primary Objectives

* **Central Configuration:** Single place to configure, monitor, and operate Project Athena
* **Real-Time Updates:** No service restarts required; safe-apply with validation and rollback
* **Role-Based Access:** Clear separation of Owner vs Operator vs Viewer vs Support permissions
* **Guest Mode Support:** First-class support for Guest Mode policies and Airbnb integration
* **Observability:** Embedded metrics, request tracing, feedback management
* **Security First:** OIDC authentication, secrets management, audit logging

### Key Features

✅ **Live Policy Editor** - Edit guest/owner policies with YAML + form side-by-side
✅ **Safe-Apply Workflow** - Dry-run validation → apply → health check → auto-rollback on failure
✅ **Device Management** - HA Voice device registry, room mapping, audio testing
✅ **RAG Configuration** - Enable/disable sources, API key management, cache controls
✅ **Request Explorer** - Search, filter, trace requests with full timing breakdowns
✅ **Feedback Queue** - Review bad answers, bulk triage, pattern analysis
✅ **Audit Logs** - Tamper-evident logs of all configuration changes
✅ **Export/Import** - SOPS-encrypted config snapshots with versioning

---

## 2) Architecture & Tech Stack

### Recommended Stack

**Frontend:**
- **Framework:** Next.js 14+ (React 18)
- **Styling:** Tailwind CSS
- **Rendering:** SSR + SPA hybrid (App Router)
- **State:** Zustand or React Context
- **Forms:** React Hook Form + Zod validation
- **Charts:** Recharts or Chart.js
- **Real-time:** WebSocket client or SSE

**Backend:**
- **Framework:** FastAPI (Python 3.11+)
- **Auth:** OIDC (Authentik/Keycloak) with RBAC
- **Database:** PostgreSQL 15+ (config, policies, audit logs)
- **Cache:** Redis (session cache, WS presence, rate limits)
- **Real-time:** WebSockets (via FastAPI WebSocket) or SSE
- **Secrets:** SOPS-encrypted YAML or HashiCorp Vault
- **API Docs:** OpenAPI 3.1 (auto-generated by FastAPI)

**Deployment:**
- **Option A:** Single Docker image (Next.js static build served by FastAPI)
- **Option B:** Two services (Next.js + FastAPI) behind Traefik
- **Networking:** Same Docker network as other Athena services
- **Ports:** 3000 (Next.js dev) or 8080 (FastAPI prod)
- **TLS:** Handled by Traefik with Let's Encrypt

### Services Integration

The Admin Interface communicates with:

1. **Mode Service** (`http://mode-service:8001`)
   - Get current mode (guest/owner)
   - Set manual override
   - View booking schedule
   - Configure Airbnb calendar

2. **Orchestrator** (`http://orchestrator:8002`)
   - Push policy updates
   - Get pipeline health
   - View feature flags
   - Query request traces

3. **Home Assistant** (`https://192.168.10.168:8123`)
   - Entity discovery
   - Test actions
   - Scene/script registry
   - Device registry

4. **RAG Connectors** (various services)
   - Configure API keys
   - Set rate limits
   - Invalidate caches
   - Test connectivity

5. **Prometheus/Grafana** (existing infrastructure)
   - Read-only tokens for embedded panels
   - Query metrics via PromQL
   - Export Grafana dashboard JSON

6. **Notification Services**
   - Twilio API (SMS)
   - SMTP/SendGrid (Email)
   - Test message sending

### Data Store Schema

**PostgreSQL Tables:**

```sql
-- Policy configurations
CREATE TABLE policies (
    id SERIAL PRIMARY KEY,
    mode VARCHAR(16) NOT NULL,  -- "guest" or "owner"
    config JSONB NOT NULL,
    version INTEGER NOT NULL DEFAULT 1,
    created_by VARCHAR(255) NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    active BOOLEAN DEFAULT TRUE,
    UNIQUE(mode, version)
);

CREATE INDEX idx_policies_mode_active ON policies(mode, active);

-- Policy version history
CREATE TABLE policy_versions (
    id SERIAL PRIMARY KEY,
    policy_id INTEGER REFERENCES policies(id),
    before_config JSONB,
    after_config JSONB,
    diff JSONB,  -- Structured diff
    applied_by VARCHAR(255) NOT NULL,
    applied_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    rollback_id INTEGER REFERENCES policy_versions(id)  -- If this was a rollback
);

-- Secret references (actual secrets in Vault/SOPS)
CREATE TABLE secrets (
    key VARCHAR(255) PRIMARY KEY,
    provider VARCHAR(64) NOT NULL,  -- "vault", "sops", "env"
    provider_ref VARCHAR(512) NOT NULL,  -- Path/key in provider
    category VARCHAR(64),  -- "rag", "notification", "auth"
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    last_tested TIMESTAMP WITH TIME ZONE,
    test_status VARCHAR(32)  -- "success", "failed", "pending"
);

-- Airbnb bookings (synced from Mode Service)
CREATE TABLE airbnb_bookings (
    stay_id VARCHAR(64) PRIMARY KEY,
    start_time TIMESTAMP WITH TIME ZONE NOT NULL,
    end_time TIMESTAMP WITH TIME ZONE NOT NULL,
    status VARCHAR(32) NOT NULL,  -- "upcoming", "active", "completed", "cancelled"
    source VARCHAR(64) NOT NULL,  -- "airbnb_ical", "hostaway_webhook"
    cache_ts TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    FOREIGN KEY stay_id REFERENCES bookings(stay_id) IN mode_service DB
);

-- Device registry
CREATE TABLE devices (
    id VARCHAR(64) PRIMARY KEY,
    device_type VARCHAR(32) NOT NULL,  -- "ha_voice", "wyoming_satellite"
    room VARCHAR(64),
    ip_address INET,
    status VARCHAR(32) DEFAULT 'unknown',  -- "online", "offline", "unknown"
    last_seen TIMESTAMP WITH TIME ZONE,
    config JSONB,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Request traces (synced from orchestrator logs)
CREATE TABLE requests (
    trace_id VARCHAR(64) PRIMARY KEY,
    timestamp TIMESTAMP WITH TIME ZONE NOT NULL,
    mode VARCHAR(16) NOT NULL,
    room VARCHAR(64),
    category VARCHAR(64),
    models JSONB,  -- Array of model names used
    timings JSONB,  -- Stage-by-stage timing breakdown
    success BOOLEAN NOT NULL,
    error_type VARCHAR(64),
    FOREIGN KEY trace_id REFERENCES requests(request_id) IN orchestrator DB
);

CREATE INDEX idx_requests_timestamp ON requests(timestamp DESC);
CREATE INDEX idx_requests_mode_success ON requests(mode, success);

-- Response data
CREATE TABLE responses (
    trace_id VARCHAR(64) PRIMARY KEY REFERENCES requests(trace_id),
    text_hash VARCHAR(64),  -- Hash of response text
    citations JSONB,  -- Array of sources with freshness
    hedge_used BOOLEAN DEFAULT FALSE,
    validated BOOLEAN NOT NULL,
    validation_details JSONB
);

-- Feedback queue
CREATE TABLE feedback (
    id SERIAL PRIMARY KEY,
    trace_id VARCHAR(64) REFERENCES requests(trace_id),
    verdict VARCHAR(16) NOT NULL,  -- "good", "bad", "neutral"
    reason VARCHAR(64),
    comment TEXT,
    tags JSONB,  -- Array of tags for categorization
    submitted_by VARCHAR(255),
    submitted_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    reviewed BOOLEAN DEFAULT FALSE,
    reviewed_by VARCHAR(255),
    reviewed_at TIMESTAMP WITH TIME ZONE
);

CREATE INDEX idx_feedback_verdict ON feedback(verdict, submitted_at DESC);
CREATE INDEX idx_feedback_reviewed ON feedback(reviewed);

-- Audit logs (tamper-evident)
CREATE TABLE audit_logs (
    id SERIAL PRIMARY KEY,
    actor VARCHAR(255) NOT NULL,  -- User from OIDC
    action VARCHAR(128) NOT NULL,  -- "policy.update", "mode.override", etc.
    target VARCHAR(255),  -- Resource affected
    before JSONB,
    after JSONB,
    timestamp TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
    ip_address INET,
    user_agent TEXT,
    signature VARCHAR(512)  -- HMAC of (id + actor + action + target + timestamp)
);

CREATE INDEX idx_audit_logs_actor ON audit_logs(actor, timestamp DESC);
CREATE INDEX idx_audit_logs_action ON audit_logs(action, timestamp DESC);
```

---

## 3) Navigation & Screens (v1)

### A. Overview (Dashboard)

**Purpose:** At-a-glance system health and quick actions

**Components:**

1. **Mode Indicator** (large badge)
   - Current mode: GUEST or OWNER
   - Reason: "Manual override" / "Active booking" / "Default"
   - Next change countdown (if applicable)

2. **Pipeline Health** (status cards)
   - Gateway: OK / WARN / ERROR
   - Orchestrator: OK / WARN / ERROR
   - Mode Service: OK / WARN / ERROR
   - Vector DB: OK / WARN / ERROR
   - HA Connection: OK / WARN / ERROR

3. **Performance Metrics** (mini charts)
   - p50/p95 latency (control vs knowledge)
   - Success rate (last 1h, 24h, 7d)
   - Requests per minute

4. **Recent Requests** (table)
   - Last 10 requests
   - Columns: Time, Mode, Room, Query, Result, Latency
   - Click to view full trace

5. **Quick Actions** (buttons)
   - Toggle Guest Mode (with PIN prompt)
   - Safe Apply Config
   - Rollback to Previous
   - Purge Guest Data
   - View Booking Schedule

**API Endpoints:**
- `GET /api/dashboard` → aggregated dashboard data
- `GET /api/health` → all service health checks
- `GET /api/metrics/summary` → p50/p95/success rate

---

### B. Modes & Policies

**Purpose:** Configure guest and owner mode policies

**Layout:** Two-column with YAML editor + form

**Sections:**

**1. Mode Selection**
- Tabs: Guest Mode / Owner Mode
- Status badge showing currently active mode

**2. Home Assistant Control Scope**
- **Allowed Scenes:** Multi-select with autocomplete from HA
- **Allowed Domains:** Checkboxes (light, switch, media_player, etc.)
- **Denied Entities:** Entity picker with pattern support (`lock.*`, `alarm_control_panel.*`)
- **Caps:**
  - Max Brightness: Slider (0-100%)
  - Max Volume: Slider (0-100%)
- **Quiet Hours:**
  - Enable toggle
  - Start time: Time picker
  - End time: Time picker
  - Denied domains during quiet hours: Multi-select

**3. Information Categories**
- **Allowed Categories:** Checkboxes
  - Weather, News, Events, Transport, Airports, Flights
  - Sports, Recipes, Streaming, Dining, Property Info
- **Denied Categories:** (for owner mode, usually empty)
  - Owner Calendar, Owner Contacts, Security Logs, Camera Feeds

**4. Sharing Capabilities**
- **SMS Enabled:** Toggle
- **Email Enabled:** Toggle
- **Phone Whitelist:** Text area (one per line) or empty for "any"
- **Max SMS per Day:** Number input
- **Max Email per Day:** Number input
- **Redact Personal Data:** Toggle (always on for guest)

**5. Data Retention & Privacy**
- **Request Logs (days):** Number input
- **Response Logs (days):** Number input
- **PII Scrub:** Toggle (forced on for guest)
- **Purge on Checkout:** Toggle (forced on for guest)
- **Purge Delay (hours):** Number input

**6. Validation & Guardrails**
- **Anti-Hallucination Level:** Dropdown (balanced / strict / paranoid)
- **Cross-Model Validation:** Dropdown (off / auto_high_stakes / always)
- **Retrieval Confidence Threshold:** Slider (0.0-1.0)
- **Web Search Scope:** Multi-select (trusted_news, official_airports, city_sites, event_apis)
- **Blocked Domains:** Text area (one per line)

**7. YAML Preview**
- Live-updated YAML representation of form
- Editable (changes sync back to form)
- Syntax highlighting
- Diff view when comparing to current active policy

**8. Actions**
- **Dry Run:** Validate policy without applying
- **Apply:** Safe-apply workflow (validation → apply → health check)
- **Revert:** Load currently active policy
- **Export:** Download as SOPS-encrypted YAML

**API Endpoints:**
- `GET /api/policy/{mode}` → current policy for mode
- `PUT /api/policy/{mode}` → update policy (dry-run or apply)
- `POST /api/policy/dry-run` → validate without applying
- `GET /api/policy/effective?room=X&entity=Y` → preview effective permissions
- `POST /api/policy/apply` → transactional apply
- `POST /api/policy/rollback?version=X` → rollback to version

---

### C. Voice & Devices

**Purpose:** Configure wake words, TTS/STT, and manage voice devices

**Sections:**

**1. Wake Words**
- **Jarvis:**
  - Enable toggle
  - Detection threshold: Slider (0.0-1.0)
  - Audio sample: Play button
- **Athena:**
  - Enable toggle
  - Detection threshold: Slider (0.0-1.0)
  - Audio sample: Play button

**2. Text-to-Speech (TTS)**
- **Model:** Dropdown (piper models)
- **Voice:** Dropdown (available voices for selected model)
- **Speed:** Slider (0.8-1.5x)
- **Volume:** Slider (0-100%)
- **Sample:** Text input + "Test TTS" button

**3. Speech-to-Text (STT)**
- **Model:** Dropdown (Faster-Whisper models: tiny.en, base.en, small.en, etc.)
- **Language:** Dropdown (en, es, fr, etc.)
- **Sample:** Record audio + "Test STT" button

**4. Device Registry**
- **Table:**
  - Columns: Name, Type, Room, IP, Status, Last Seen, Actions
  - Filters: By room, by status, search by name
- **Device Actions:**
  - Mic Test: Record 5s audio, show waveform
  - Speaker Test: Play test tone
  - Reboot: Trigger device reboot
  - Edit: Change room/area assignment
  - Remove: Unregister device

**5. Room/Area Mapping**
- **Table:**
  - Columns: Room Name, HA Area, Devices Assigned, Occupancy Tracking
  - Sync from HA button (auto-discover areas)
  - Override mapping: Drag-and-drop devices to rooms

**API Endpoints:**
- `GET /api/voice/wakewords` → current wake word config
- `PUT /api/voice/wakewords` → update wake word settings
- `GET /api/voice/tts` → TTS config
- `PUT /api/voice/tts` → update TTS config
- `POST /api/voice/tts/test` → generate test audio
- `GET /api/voice/stt` → STT config
- `PUT /api/voice/stt` → update STT config
- `POST /api/voice/stt/test` → transcribe uploaded audio
- `GET /api/devices` → list all devices
- `GET /api/devices/{id}` → device details
- `POST /api/devices/{id}/test-mic` → trigger mic test
- `POST /api/devices/{id}/test-speaker` → trigger speaker test
- `POST /api/devices/{id}/reboot` → reboot device
- `PUT /api/devices/{id}` → update device (room, name)
- `DELETE /api/devices/{id}` → unregister device
- `GET /api/rooms` → list rooms with device assignments
- `POST /api/rooms/sync-from-ha` → sync HA areas

---

### D. Home Assistant

**Purpose:** Manage HA integration, test entities, configure scenes

**Sections:**

**1. Connection Status**
- **Status Badge:** Connected / Disconnected / Error
- **URL:** Display HA URL (192.168.10.168:8123)
- **Token:** Masked, with "Test Connection" button
- **Last Sync:** Timestamp of last entity sync
- **Sync Now:** Button to force entity registry refresh

**2. Entity Discovery**
- **Search:** Text input with autocomplete
- **Filters:**
  - Domain: Dropdown (light, switch, media_player, etc.)
  - Area: Multi-select
  - Capabilities: Checkboxes (dimmable, color, position, etc.)
- **Table:**
  - Columns: Entity ID, Friendly Name, Domain, Area, State, Capabilities
  - Click row to view details

**3. Entity Details Modal**
- **Basic Info:**
  - Entity ID
  - Friendly Name
  - Domain
  - Device Class
  - Current State
  - Attributes (JSON tree)
- **Capabilities:**
  - Supported features (list)
  - Value ranges (e.g., brightness 0-255, color temp 2000-6500K)
- **Test Actions:**
  - Service dropdown (turn_on, turn_off, toggle, set_brightness, etc.)
  - Parameters: Form fields based on service schema
  - Dry Run checkbox
  - Execute button

**4. Scene & Script Allowlist**
- **Scenes Table:**
  - Columns: Scene ID, Name, Entities Affected, Guest Allowed, Actions
  - Toggle "Guest Allowed" to add/remove from guest policy
- **Scripts Table:**
  - Same structure as scenes
  - Test button to execute script with parameters

**API Endpoints:**
- `GET /api/ha/status` → connection status
- `POST /api/ha/test-connection` → verify HA connectivity
- `GET /api/ha/entities` → list all entities (cached, with filters)
- `POST /api/ha/sync-entities` → force sync from HA
- `GET /api/ha/entities/{id}` → entity details
- `POST /api/ha/test-action` → execute test action (dry-run or real)
- `GET /api/ha/scenes` → list scenes
- `PUT /api/ha/scenes/{id}/guest-allow` → toggle guest access
- `GET /api/ha/scripts` → list scripts
- `PUT /api/ha/scripts/{id}/guest-allow` → toggle guest access

---

### E. Knowledge & RAG

**Purpose:** Configure RAG sources, API keys, region context

**Sections:**

**1. Region Context**
- **Property Address:** Text input (default: "912 South Clinton St, Baltimore, MD 21224")
- **Geocode:** Button to verify address and get lat/long
- **Coordinates:** Display lat/long (read-only after geocode)
- **Timezone:** Dropdown (auto-detected from address)

**2. RAG Sources**
- **Table:**
  - Columns: Source, Category, Enabled, Freshness, Rate Limit, Last Updated, Status, Actions
  - Rows:
    - **Weather** (Open-Meteo/NWS): Toggle, 48h cache
    - **News** (RSS/NewsAPI): Toggle, 1h cache
    - **Events** (Ticketmaster/Meetup/Eventbrite): Toggle, 24h cache
    - **Transport** (MTA MD/Transitland): Toggle, real-time
    - **Airports** (7 airports): Toggle, real-time
    - **Flights** (cirium/aviationstack): Toggle, real-time
    - **Sports** (TheSportsDB/ESPN): Toggle, real-time
    - **Recipes** (Spoonacular): Toggle, static
    - **Streaming** (JustWatch/TMDB): Toggle, 24h cache
    - **Dining** (Yelp/Places): Toggle, 24h cache
    - **Property Info** (vector DB): Toggle, static
- **Actions per row:**
  - Configure API Key (modal with test button)
  - Set Rate Limit (requests per minute)
  - Invalidate Cache (force refresh)
  - View Sample Data (last fetched result)

**3. Airport Configuration**
- **Enabled Airports:** Multi-select with autocomplete
  - Pre-populated: PHL, BWI, EWR, LGA, JFK, IAD, DCA
  - Add more by IATA code
- **Priority Order:** Drag-and-drop to reorder (closest first)

**4. Streaming Services**
- **Enabled Services:** Checkboxes
  - Prime Video, Netflix, Disney+, Paramount+, Peacock
  - YouTube TV, Hulu, NFL Sunday Ticket
- **Deep Link Format:** Text input per service (e.g., `https://netflix.com/watch/{id}`)

**5. API Keys & Secrets**
- **Table:**
  - Columns: Service, Key Name, Status, Last Tested, Actions
  - **Add Key:** Button to add new API key
    - Service dropdown
    - Key name (e.g., "weather_api_key")
    - Value (password input, never displayed again after save)
    - Test button (makes real API call to verify)
  - **Test Key:** Button per row to verify key still works
  - **Rotate Key:** Button to replace with new value
  - **Delete Key:** Button to remove (with confirmation)

**6. Cache Management**
- **Global Actions:**
  - Invalidate All Caches
  - View Cache Stats (hit rate, size, oldest entry)
- **Per-Category:**
  - Invalidate Weather Cache
  - Invalidate News Cache
  - etc.

**API Endpoints:**
- `GET /api/rag/region` → property address and coordinates
- `PUT /api/rag/region` → update property context
- `POST /api/rag/region/geocode` → geocode address
- `GET /api/rag/sources` → list all RAG sources with status
- `PUT /api/rag/sources/{source}/enable` → enable/disable source
- `PUT /api/rag/sources/{source}/config` → update rate limit, cache TTL
- `POST /api/rag/sources/{source}/test` → test source connectivity
- `POST /api/rag/cache/invalidate` → invalidate cache (all or by source)
- `GET /api/rag/cache/stats` → cache statistics
- `GET /api/rag/airports` → list enabled airports
- `PUT /api/rag/airports` → update airport list
- `GET /api/rag/streaming` → list enabled streaming services
- `PUT /api/rag/streaming` → update streaming services
- `GET /api/secrets` → list secret references (no values)
- `POST /api/secrets` → add new secret
- `PUT /api/secrets/{key}` → update secret value
- `POST /api/secrets/{key}/test` → test secret validity
- `DELETE /api/secrets/{key}` → delete secret

---

### F. Validation (Anti-Hallucination)

**Purpose:** Configure guardrails and cross-model validation

**Sections:**

**1. Anti-Hallucination Settings**
- **Global Policy:** Dropdown (balanced / strict / paranoid)
- **Per-Category Overrides:** Table
  - Columns: Category, Policy, Confidence Threshold, Citation Required
  - Override button per row
  - Example: "Flights" → strict, 0.85 confidence, citation required

**2. Retrieval Confidence**
- **Global Threshold:** Slider (0.0-1.0)
- **Fallback Behavior:** Radio buttons
  - Block (return "I don't have enough information")
  - Hedge (return answer with strong qualifiers)
  - Allow (return answer with low confidence warning)

**3. Cross-Model Validation**
- **Enable:** Toggle
- **Trigger Policy:** Dropdown
  - Off (never use cross-model)
  - Auto for high-stakes (airports, flights, transport, health)
  - Always (every query)
- **Quorum Size:** Number input (2-5 models)
- **Agreement Threshold:** Slider (semantic similarity, 0.7-1.0)
- **Divergence Action:** Dropdown
  - Block (refuse to answer)
  - Hedge (return "conflicting info, here are sources")
  - Vote (return majority answer with note)

**4. Citation Requirements**
- **Require Citations for:** Multi-select categories
- **Citation Format:** Dropdown
  - Inline (e.g., "According to weather.gov...")
  - Footnotes (e.g., "... [1]")
  - Both

**5. Hedging Templates**
- **Low Confidence:** Text area
  - Default: "I'm not completely certain, but based on available info..."
- **Conflicting Sources:** Text area
  - Default: "I found conflicting information. Here's what each source says..."
- **Outdated Data:** Text area
  - Default: "This information may be outdated (last updated X hours ago)..."

**6. Test Scenarios**
- **Sample Queries:** Dropdown with pre-built test queries
  - "What's the weather tomorrow?" (should work)
  - "What time does my flight leave?" (high-stakes, should trigger cross-model)
  - "Who won the Super Bowl in 2030?" (should block/hedge - future event)
- **Test Button:** Executes query through full pipeline
- **Results:** Shows validation steps, confidence scores, citations

**API Endpoints:**
- `GET /api/validation/config` → all validation settings
- `PUT /api/validation/config` → update validation settings
- `GET /api/validation/thresholds` → per-category thresholds
- `PUT /api/validation/thresholds/{category}` → update category threshold
- `GET /api/validation/cross-model` → cross-model config
- `PUT /api/validation/cross-model` → update cross-model settings
- `GET /api/validation/templates` → hedging templates
- `PUT /api/validation/templates` → update templates
- `POST /api/validation/test` → run test query through validation

---

### G. Notifications

**Purpose:** Configure Twilio SMS and email (SMTP) for sharing

**Sections:**

**1. Twilio (SMS)**
- **Status Badge:** Connected / Not Configured / Error
- **Account SID:** Password input (masked after save)
- **Auth Token:** Password input (masked after save)
- **From Number:** Text input (e.g., +15551234567)
- **Test SMS:**
  - To Number: Text input
  - Message: Text area (pre-filled with test message)
  - Send Test button
  - Result: Success/failure message with details

**2. Email (SMTP/SendGrid)**
- **Status Badge:** Connected / Not Configured / Error
- **Provider:** Dropdown (SMTP Generic, SendGrid, AWS SES)
- **If SMTP Generic:**
  - Host: Text input
  - Port: Number input (25, 465, 587)
  - Username: Text input
  - Password: Password input (masked after save)
  - TLS: Toggle
- **If SendGrid:**
  - API Key: Password input (masked after save)
- **From Email:** Text input (e.g., athena@xmojo.net)
- **From Name:** Text input (e.g., "Project Athena")
- **Test Email:**
  - To Email: Text input
  - Subject: Text input (pre-filled)
  - Body: Text area (pre-filled with test message)
  - Send Test button
  - Result: Success/failure message

**3. Share Templates**
- **SMS Templates:** Expandable sections
  - Directions: Text area with variables `{destination}`, `{address}`, `{map_link}`
  - Recommendations: Text area with variables `{place_name}`, `{category}`, `{distance}`
  - Recipe: Text area with variables `{recipe_name}`, `{ingredients}`, `{url}`
  - Event Info: Text area with variables `{event_name}`, `{venue}`, `{time}`, `{tickets_link}`
- **Email Templates:** Same structure as SMS but with HTML support
  - Preview button per template

**4. Rate Limits**
- **SMS per Day (Guest):** Number input
- **SMS per Day (Owner):** Number input
- **Email per Day (Guest):** Number input
- **Email per Day (Owner):** Number input
- **Cooldown Between Shares:** Number input (seconds)

**5. Audit Log**
- **Table:**
  - Columns: Timestamp, Mode, Type (SMS/Email), Destination (masked), Status, Content Type
  - Filters: By mode, by type, by date range
  - Click row to view details (if owner mode or anonymized summary)

**API Endpoints:**
- `GET /api/notifications/twilio` → Twilio config (secrets masked)
- `PUT /api/notifications/twilio` → update Twilio config
- `POST /api/notifications/twilio/test` → send test SMS
- `GET /api/notifications/email` → email config (secrets masked)
- `PUT /api/notifications/email` → update email config
- `POST /api/notifications/email/test` → send test email
- `GET /api/notifications/templates` → all share templates
- `PUT /api/notifications/templates/{type}` → update template
- `POST /api/notifications/templates/{type}/preview` → preview rendered template
- `GET /api/notifications/rate-limits` → current rate limit config
- `PUT /api/notifications/rate-limits` → update rate limits
- `GET /api/notifications/audit` → audit log with filters

---

### H. Observability

**Purpose:** Monitor system health, explore requests, manage feedback

**Sections:**

**1. Embedded Grafana Panels**
- **Service Health:**
  - Uptime badges for each service
  - Error rate sparklines
  - Memory/CPU usage gauges
- **Latency:**
  - Heatmap: p50/p95/p99 by pipeline (control vs knowledge)
  - Time series: Latency over time by stage (STT, classify, retrieve, synthesize, validate, TTS)
- **Success Rate:**
  - Gauge: Overall success rate (last 1h, 24h, 7d)
  - Time series: Success rate over time by mode (guest vs owner)
- **Denials:**
  - Pie chart: Denial reasons (domain not allowed, entity restricted, quiet hours, category blocked)
  - Bar chart: Top denied domains/categories
- **Guardrail Hits:**
  - Counter: Policy denials, retrieval confidence fails, cross-model triggers
  - Time series: Guardrail hits over time

**2. Request Explorer**
- **Filters:**
  - Date range: Date picker (last hour, 24h, 7d, custom)
  - Mode: Dropdown (all, guest, owner)
  - Room: Multi-select
  - Category: Multi-select
  - Model: Multi-select
  - Success: Dropdown (all, success, failure)
  - Search: Text input (query text, fuzzy search)
- **Table:**
  - Columns: Timestamp, Mode, Room, Query (truncated), Category, Models, Latency, Result, Actions
  - Sortable by timestamp, latency
  - Click row to view full trace

**3. Request Trace Viewer (Modal)**
- **Overview:**
  - Request ID
  - Timestamp
  - Mode (badge)
  - Room
  - Success/failure (badge)
  - Total latency
- **Timeline:**
  - Waterfall chart showing stages:
    - Wake word detection
    - STT (with audio waveform if available)
    - Classify intent
    - Route to model
    - Retrieve context (with sources list)
    - Synthesize answer
    - Validate (with validation steps)
    - TTS (with audio player if available)
    - Share (if applicable)
- **Details Tabs:**
  - **Request:** Full text, metadata (room, device, mode)
  - **Response:** Full text, citations with freshness labels
  - **Models:** List of models used with inference times
  - **RAG:** Sources retrieved (URL, freshness, confidence)
  - **Validation:** Policy checks, retrieval confidence, cross-model results (if used)
  - **Logs:** Raw orchestrator logs for this request
- **Actions:**
  - Replay Query (re-run through pipeline)
  - Export as JSON
  - Mark as Bad Answer (if not already marked)

**4. Feedback Queue**
- **Summary Stats:**
  - Total feedback count
  - Good/Bad/Neutral distribution (pie chart)
  - Average rating by category
- **Filters:**
  - Verdict: Dropdown (all, good, bad, neutral)
  - Mode: Dropdown (all, guest, owner)
  - Category: Multi-select
  - Reviewed: Dropdown (all, reviewed, pending)
  - Date range: Date picker
- **Table:**
  - Columns: Timestamp, Mode, Query (truncated), Verdict, Reason, Reviewed, Actions
  - Sortable
  - Bulk actions: Select multiple → Mark as Reviewed, Retest Selected
- **Feedback Detail (Modal):**
  - Full query and response
  - Verdict and reason
  - Models used, sources retrieved
  - Admin notes (text area, save button)
  - Actions:
    - Mark as Reviewed
    - Retest (re-run query now)
    - View Full Trace

**5. Nightly Analysis Reports**
- **Latest Report:** Card showing summary
  - Date, total bad feedback analyzed
  - Top failure patterns (missing sources, low confidence, hallucination)
  - Improvement suggestions (list)
- **Historical Reports:** Table
  - Columns: Date, Bad Answers, Patterns Found, Status
  - Click row to view full report

**API Endpoints:**
- `GET /api/metrics/grafana-token` → read-only Grafana token for embeds
- `GET /api/requests` → list requests with filters and pagination
- `GET /api/requests/{id}` → full trace details
- `POST /api/requests/{id}/replay` → re-run query
- `GET /api/feedback` → feedback queue with filters
- `GET /api/feedback/{id}` → feedback details
- `PUT /api/feedback/{id}` → update feedback (admin notes, reviewed status)
- `POST /api/feedback/{id}/retest` → retest query
- `POST /api/feedback/bulk-review` → mark multiple as reviewed
- `GET /api/analysis/latest` → latest nightly analysis report
- `GET /api/analysis/history` → list historical reports

---

### I. Security & Secrets

**Purpose:** Manage users, roles, secrets, audit logs

**Sections:**

**1. Users & Roles**
- **OIDC Integration Status:**
  - Provider: Authentik / Keycloak
  - Client ID: Display only
  - Connection status: Badge
- **User List:**
  - Table: Username, Email, Roles, Last Login, Status, Actions
  - Roles displayed as badges (Owner, Operator, Viewer, Support)
  - Actions: Edit Roles, Deactivate, View Audit Log
- **Role Definitions:** Expandable cards
  - **Owner:**
    - Permissions: Full access, view secrets, apply/rollback, purge data
    - Users: List of users with Owner role
  - **Operator:**
    - Permissions: Edit settings, cannot view raw secrets, cannot change owners
    - Users: List
  - **Viewer:**
    - Permissions: Read-only (including metrics), submit feedback
    - Users: List
  - **Support:**
    - Permissions: Toggle guest override, run tests, no policy edits
    - Users: List
- **Add User:** Button (opens modal)
  - Search OIDC users
  - Assign roles
  - Set expiration (optional)

**2. API Keys & Secrets**
- **Service API Keys:** Table
  - Columns: Service, Key Name, Type (RAG/Notification/Auth), Status, Last Tested, Actions
  - Add Key button → modal with service, name, value, test button
  - Test button per row (makes real API call)
  - Rotate button (enter new value, old value invalidated)
  - Delete button (with confirmation)
- **Secrets Store:** Radio buttons
  - SOPS (file-based, encrypted YAML)
  - HashiCorp Vault (external secret store)
  - Environment Variables (read-only, for container deployments)
- **Vault Configuration (if Vault selected):**
  - Vault URL
  - Token (masked)
  - Mount Path
  - Test Connection button

**3. Session Management**
- **Session Timeout:** Number input (minutes)
- **Require 2FA:** Toggle (enforced via OIDC)
- **Concurrent Sessions:** Number input (max sessions per user)
- **Active Sessions:** Table
  - Columns: User, IP, User Agent, Started, Last Activity, Actions
  - Revoke button per row

**4. Audit Log**
- **Filters:**
  - Actor: Dropdown (all users)
  - Action: Multi-select (policy.update, mode.override, secret.add, etc.)
  - Date range: Date picker
  - Search: Text input (target resource, e.g., "guest policy")
- **Table:**
  - Columns: Timestamp, Actor, Action, Target, IP Address, Status
  - Click row to view details
- **Audit Detail (Modal):**
  - Before/After diff (JSON tree view with highlights)
  - Signature verification status
  - User agent, IP address
  - Related audit entries (same target within 1 hour)

**API Endpoints:**
- `GET /api/auth/oidc-status` → OIDC provider connection status
- `GET /api/users` → list users with roles
- `PUT /api/users/{id}/roles` → update user roles
- `POST /api/users/{id}/deactivate` → deactivate user
- `GET /api/roles` → list role definitions
- `GET /api/secrets` → list secret references (no values)
- `POST /api/secrets` → add new secret
- `PUT /api/secrets/{key}` → update secret value
- `POST /api/secrets/{key}/test` → test secret validity
- `DELETE /api/secrets/{key}` → delete secret
- `GET /api/secrets/vault-config` → Vault configuration (if using Vault)
- `PUT /api/secrets/vault-config` → update Vault config
- `GET /api/sessions` → list active sessions
- `DELETE /api/sessions/{id}` → revoke session
- `GET /api/audit` → audit log with filters
- `GET /api/audit/{id}` → audit entry details
- `POST /api/audit/{id}/verify-signature` → verify tamper-evident signature

---

### J. Packaging & Export

**Purpose:** Export/import configuration, manage snapshots, generate OSS presets

**Sections:**

**1. Configuration Export**
- **Export Options:**
  - Include secrets: Toggle (requires Owner role)
  - Include audit log: Toggle
  - Encryption: Radio buttons (SOPS / Vault / None)
  - Format: Radio buttons (YAML / JSON)
- **Export Button:** Downloads file
  - Filename: `athena-config-{date}.yaml`

**2. Configuration Import**
- **Upload File:** File picker (YAML or JSON)
- **Preview:** Shows diff between current and uploaded config
  - Added/removed/changed keys highlighted
  - Secrets shown as `[ENCRYPTED]` in preview
- **Dry Run:** Button to validate without applying
  - Shows validation errors
  - Shows services that will be affected
- **Import Button:** Applies configuration
  - Triggers safe-apply workflow
  - Shows progress (validate → backup → apply → health check)
  - Auto-rollback on failure

**3. Configuration Snapshots**
- **Table:**
  - Columns: Version, Timestamp, Created By, Description, Size, Actions
  - Sortable by timestamp
- **Create Snapshot:** Button
  - Description: Text input
  - Create button
- **Actions per row:**
  - View: Preview snapshot contents
  - Restore: Safe-apply workflow to restore this snapshot
  - Download: Download snapshot file
  - Delete: Remove snapshot (with confirmation)

**4. Version History**
- **Table:**
  - Columns: Version, Timestamp, Actor, Changes Summary, Rollback Available
  - Click row to view full diff
- **Diff Viewer (Modal):**
  - Side-by-side JSON diff
  - Highlight added/removed/changed keys
  - Rollback button (if not current version)

**5. Open-Source Preset Generator**
- **Purpose:** Generate generic config for OSS release (strip private data)
- **Options:**
  - Replace Baltimore address with: Text input (default: "123 Sample St, Sample City, ST 12345")
  - Replace API keys with: Dropdown (placeholders / example keys / removed)
  - Include sample bookings: Toggle
  - Include sample devices: Toggle
- **Generate Button:** Downloads `athena-config-oss.yaml`

**API Endpoints:**
- `POST /api/config/export` → export configuration (returns file)
- `POST /api/config/import` → upload config file (returns preview)
- `POST /api/config/import/dry-run` → validate without applying
- `POST /api/config/import/apply` → apply imported config
- `GET /api/config/snapshots` → list snapshots
- `POST /api/config/snapshots` → create snapshot
- `GET /api/config/snapshots/{id}` → download snapshot
- `POST /api/config/snapshots/{id}/restore` → restore snapshot
- `DELETE /api/config/snapshots/{id}` → delete snapshot
- `GET /api/config/versions` → version history
- `GET /api/config/versions/{id}` → view version details
- `POST /api/config/versions/{id}/rollback` → rollback to version
- `POST /api/config/generate-oss` → generate OSS preset

---

## 4) RBAC Model

### Roles & Permissions

**Owner (Full Access)**
- ✅ View secrets (raw API keys, tokens)
- ✅ Apply/rollback configuration
- ✅ Purge guest data
- ✅ Manage users and roles
- ✅ Delete audit logs (emergency only, logged)
- ✅ All Operator permissions

**Operator (Admin)**
- ✅ Edit policies (guest/owner modes)
- ✅ Configure devices, wake words, TTS/STT
- ✅ Configure RAG sources (but cannot view raw API keys)
- ✅ Configure validation rules
- ✅ Manage notifications (but cannot view raw tokens)
- ✅ View audit logs
- ✅ Export configuration (without secrets)
- ❌ View raw secrets
- ❌ Manage users/roles
- ❌ Purge guest data
- ❌ Delete audit logs

**Viewer (Read-Only)**
- ✅ View dashboard, metrics, Grafana panels
- ✅ View request traces
- ✅ Submit feedback ("mark as bad answer")
- ✅ View policies (effective permissions)
- ✅ View device registry
- ✅ View audit logs (own actions only)
- ❌ Edit any configuration
- ❌ View secrets
- ❌ Apply/rollback

**Support (Troubleshooting)**
- ✅ Toggle guest mode override (temporary)
- ✅ Run device tests (mic, speaker, reboot)
- ✅ Run entity tests (HA test actions)
- ✅ View request traces and logs
- ✅ Submit feedback
- ✅ View device registry
- ❌ Edit policies
- ❌ View secrets
- ❌ Apply/rollback
- ❌ Purge data

### Permission Matrix

| Feature | Owner | Operator | Viewer | Support |
|---------|-------|----------|--------|---------|
| View Dashboard | ✅ | ✅ | ✅ | ✅ |
| Edit Guest/Owner Policies | ✅ | ✅ | ❌ | ❌ |
| Toggle Guest Mode Override | ✅ | ✅ | ❌ | ✅ |
| View Raw Secrets | ✅ | ❌ | ❌ | ❌ |
| Add/Edit/Delete Secrets | ✅ | ✅* | ❌ | ❌ |
| Configure Devices | ✅ | ✅ | ❌ | ❌ |
| Test Devices | ✅ | ✅ | ❌ | ✅ |
| Configure RAG Sources | ✅ | ✅ | ❌ | ❌ |
| Configure Validation Rules | ✅ | ✅ | ❌ | ❌ |
| Configure Notifications | ✅ | ✅ | ❌ | ❌ |
| View Request Traces | ✅ | ✅ | ✅ | ✅ |
| Submit Feedback | ✅ | ✅ | ✅ | ✅ |
| Review Feedback Queue | ✅ | ✅ | ❌ | ❌ |
| Apply Configuration | ✅ | ❌ | ❌ | ❌ |
| Rollback Configuration | ✅ | ❌ | ❌ | ❌ |
| Purge Guest Data | ✅ | ❌ | ❌ | ❌ |
| Manage Users/Roles | ✅ | ❌ | ❌ | ❌ |
| View Audit Logs | ✅ | ✅ | Own only | Own only |
| Export Config (with secrets) | ✅ | ❌ | ❌ | ❌ |
| Export Config (without secrets) | ✅ | ✅ | ❌ | ❌ |

*Operator can add/edit secrets but cannot view them after save

---

## 5) API Specification

### Authentication

**OIDC Flow:**
1. User visits admin UI → redirected to OIDC provider (Authentik/Keycloak)
2. User authenticates
3. OIDC provider redirects back with authorization code
4. Backend exchanges code for ID token + access token
5. Backend verifies token, extracts user info and groups
6. Backend maps OIDC groups to RBAC roles
7. Backend issues session cookie (httpOnly, secure, SameSite=Strict)
8. All API requests include session cookie + CSRF token

**Session Management:**
- Session stored in Redis with TTL (default 1 hour, configurable)
- Session includes: user ID, username, email, roles, IP, user agent
- CSRF token rotated on each state-changing request
- Concurrent session limit enforced (default 3 per user)

### API Base URL

```
https://admin.athena.xmojo.net/api
```

### Common Headers

**Request:**
```
Authorization: Bearer {session_token}  (or session cookie)
X-CSRF-Token: {csrf_token}
Content-Type: application/json
```

**Response:**
```
Content-Type: application/json
X-RateLimit-Remaining: {count}
X-RateLimit-Reset: {timestamp}
```

### Error Responses

**Standard Error Format:**
```json
{
  "error": {
    "code": "POLICY_VALIDATION_FAILED",
    "message": "Policy validation failed: brightness cap must be 0-100",
    "details": {
      "field": "scope.max_brightness",
      "value": 150,
      "constraint": "max: 100"
    }
  }
}
```

**HTTP Status Codes:**
- 200: Success
- 201: Created
- 400: Bad Request (validation error)
- 401: Unauthorized (not authenticated)
- 403: Forbidden (insufficient permissions)
- 404: Not Found
- 409: Conflict (e.g., version mismatch)
- 429: Too Many Requests (rate limited)
- 500: Internal Server Error

### Key Endpoints (Summary)

**Full API specification with request/response schemas is in Section 3 (Navigation & Screens) under each screen.**

**Core APIs:**
- `/api/dashboard` - Dashboard summary
- `/api/health` - System health checks
- `/api/mode/*` - Mode management
- `/api/policy/*` - Policy CRUD, apply, rollback
- `/api/ha/*` - Home Assistant integration
- `/api/devices/*` - Device management
- `/api/voice/*` - Wake word, TTS, STT config
- `/api/rag/*` - RAG sources, API keys, region
- `/api/validation/*` - Guardrails, cross-model
- `/api/notifications/*` - Twilio, SMTP config
- `/api/requests/*` - Request explorer, traces
- `/api/feedback/*` - Feedback queue, review
- `/api/secrets/*` - Secret management
- `/api/users/*` - User/role management
- `/api/audit/*` - Audit logs
- `/api/config/*` - Export, import, snapshots

---

## 6) Realtime & Safe-Apply Workflow

### Live Preview

**Purpose:** Show impact of configuration changes before applying

**Flow:**
1. User edits policy in form or YAML
2. Frontend sends `POST /api/policy/dry-run` with updated config
3. Backend validates:
   - Schema validation (required fields, types, ranges)
   - Semantic validation (entity IDs exist in HA, API keys valid format)
   - Test calls (optional: actually test API keys with real requests)
4. Backend returns impact report:
   ```json
   {
     "valid": true,
     "warnings": [],
     "changes": {
       "entities_affected": ["light.living_room", "lock.front_door"],
       "categories_changed": ["weather", "news"],
       "api_keys_changed": ["weather_api_key"]
     },
     "estimated_impact": {
       "services_requiring_restart": [],
       "services_requiring_reload": ["orchestrator", "rag_connectors"]
     }
   }
   ```
5. Frontend displays impact list with warnings
6. User reviews and decides to apply or cancel

### Safe-Apply Workflow

**Purpose:** Apply configuration with health checks and auto-rollback

**Flow:**
1. User clicks "Apply" button
2. Frontend sends `POST /api/policy/apply`
3. Backend starts transactional apply:
   ```
   ┌─────────────────────────────────────────────────┐
   │ 1. Create snapshot (backup current config)      │
   │ 2. Write new config to database                 │
   │ 3. Validate schema again (defensive)            │
   │ 4. Push config to affected services:            │
   │    - Mode Service (if mode rules changed)       │
   │    - Orchestrator (policy updates)              │
   │    - RAG Connectors (if sources changed)        │
   │    - HA Bridge (if allowlists changed)          │
   │ 5. Wait for services to acknowledge (5s timeout)│
   │ 6. Run health checks (20s window):              │
   │    - Gateway responding?                        │
   │    - Orchestrator healthy?                      │
   │    - Test query succeeds?                       │
   │ 7. If all healthy → COMMIT                      │
   │    If any fail → ROLLBACK                       │
   └─────────────────────────────────────────────────┘
   ```
4. Backend returns result:
   ```json
   {
     "success": true,
     "change_set_id": "cs_20251111_153045",
     "applied_at": "2025-11-11T15:30:45Z",
     "services_affected": ["orchestrator", "rag_connectors"],
     "health_checks": {
       "gateway": "ok",
       "orchestrator": "ok",
       "mode_service": "ok",
       "test_query": "ok"
     }
   }
   ```
5. Frontend shows success message with change set ID
6. Frontend refreshes affected views (e.g., policy editor, dashboard)

### Rollback Workflow

**Purpose:** Revert to previous configuration version

**Flow:**
1. User navigates to Version History or Snapshots
2. User selects version to rollback to
3. Frontend sends `POST /api/config/rollback` with version ID
4. Backend runs same safe-apply workflow but with old config
5. Backend marks rollback in audit log with reason
6. If rollback also fails → emergency mode (load last known good config from file)

### Automatic Rollback

**Triggers:**
- Health check fails after apply (within 20s window)
- Service fails to acknowledge config push (5s timeout)
- Test query fails after apply

**Process:**
1. Backend detects failure
2. Backend automatically reverts to snapshot created in step 1 of apply
3. Backend re-pushes old config to services
4. Backend logs rollback event in audit log
5. Backend returns error to frontend with rollback status
6. Frontend shows error message: "Apply failed, automatically rolled back to previous version"

---

## 7) Security Hardening

### Authentication & Authorization

**OIDC Integration:**
- Only OIDC authentication supported (no local accounts)
- OIDC provider: Authentik or Keycloak (configured via environment variables)
- Groups mapped to roles via config file
  ```yaml
  # role_mapping.yaml
  owner_groups:
    - "athena-owners"
    - "admins"
  operator_groups:
    - "athena-operators"
  viewer_groups:
    - "athena-viewers"
  support_groups:
    - "athena-support"
  ```

**CSRF Protection:**
- All state-changing requests (POST, PUT, DELETE) require CSRF token
- Token generated on login, stored in session
- Token included in `X-CSRF-Token` header
- Token rotated after each state-changing request

**CORS Policy:**
- Strict CORS: Only admin UI origin allowed
- Credentials required (cookies)
- No wildcard origins

### Secrets Management

**Storage Options:**

**Option 1: SOPS (File-Based)**
- Secrets stored in `secrets.yaml` file
- Encrypted with age or PGP key
- Key stored in environment variable or mounted file
- Secrets decrypted on backend startup
- Never written back to file (read-only)

**Option 2: HashiCorp Vault**
- Secrets stored in Vault KV store
- Backend authenticates with Vault token (renewable)
- Secrets fetched on-demand with TTL
- Vault audit logging enabled

**Secrets in Database:**
- Only store reference (key name, provider type, provider path)
- Never store plaintext secrets in database
- Example:
  ```json
  {
    "key": "weather_api_key",
    "provider": "vault",
    "provider_ref": "secret/athena/rag/weather",
    "last_tested": "2025-11-11T15:00:00Z"
  }
  ```

**Secrets in API Responses:**
- Secrets never returned after initial save
- API returns `[ENCRYPTED]` placeholder
- Test button validates secret without revealing value
- Example:
  ```json
  {
    "key": "weather_api_key",
    "value": "[ENCRYPTED]",
    "status": "valid",
    "last_tested": "2025-11-11T15:00:00Z"
  }
  ```

### Audit Logging

**Tamper-Evident Logs:**
- Each audit entry includes HMAC signature
- Signature computed from: `HMAC(secret, id + actor + action + target + timestamp)`
- Signature verified on read
- Tampering detected if signature mismatch

**Audit Log Storage:**
- Separate PostgreSQL table with append-only writes
- No DELETE allowed (except emergency by Owner with second auth)
- Indexes on actor, action, timestamp for fast queries

**Audit Log Entries:**
```json
{
  "id": 12345,
  "actor": "jay.stuart@xmojo.net",
  "action": "policy.update",
  "target": "guest_policy",
  "before": {/* previous config */},
  "after": {/* new config */},
  "timestamp": "2025-11-11T15:30:45Z",
  "ip_address": "192.168.10.100",
  "user_agent": "Mozilla/5.0...",
  "signature": "a1b2c3d4..."
}
```

### Rate Limiting

**Dangerous Operations:**
- Apply config: 5 per hour per user
- Rollback: 10 per hour per user
- Purge guest data: 10 per day per user
- Test secret: 20 per hour per user
- Send test notification: 10 per hour per user

**General API:**
- Read endpoints: 1000 per hour per user
- Write endpoints: 100 per hour per user

**Implementation:**
- Redis-based rate limiter
- Keys: `ratelimit:{user_id}:{endpoint}:{window}`
- Sliding window algorithm
- Return 429 with `Retry-After` header when exceeded

### Network Security

**TLS:**
- All traffic over HTTPS
- TLS 1.3 minimum
- Strong cipher suites only
- HSTS header enabled

**Firewall:**
- Admin UI only accessible from allowed IPs (optional, configured in Traefik)
- Internal services (Mode, Orchestrator, etc.) only accessible within Docker network
- PostgreSQL and Redis not exposed externally

**Service-to-Service Auth:**
- API keys for service-to-service communication
- Keys rotated monthly (automated via cron job)
- Keys stored in Vault or SOPS

---

## 8) Integration with Other Services

### Mode Service Integration

**Admin UI → Mode Service:**

**Get Current Mode:**
```http
GET http://mode-service:8001/mode/current
Authorization: Bearer {service_api_key}

Response:
{
  "mode": "guest",
  "reason": "active_booking",
  "stay_id": "abc123",
  "checkin": "2025-11-15T15:00:00Z",
  "checkout": "2025-11-17T11:00:00Z",
  "next_change": "2025-11-17T12:00:00Z"
}
```

**Set Manual Override:**
```http
POST http://mode-service:8001/mode/override
Authorization: Bearer {service_api_key}
Content-Type: application/json

{
  "mode": "owner",
  "pin": "1234",
  "duration_minutes": 60
}

Response:
{
  "success": true,
  "mode": "owner",
  "expires_at": "2025-11-11T16:30:00Z"
}
```

**Configure Airbnb Calendar:**
```http
PUT http://mode-service:8001/calendar/config
Authorization: Bearer {service_api_key}
Content-Type: application/json

{
  "ical_url": "https://airbnb.com/calendar/ical/...",
  "poll_interval_minutes": 10,
  "buffer_before_checkin_hours": 2,
  "buffer_after_checkout_hours": 1
}
```

---

### Orchestrator Integration

**Admin UI → Orchestrator:**

**Push Policy Update:**
```http
POST http://orchestrator:8002/config/reload
Authorization: Bearer {service_api_key}
Content-Type: application/json

{
  "config_version": "v123",
  "policies": {
    "guest": {/* guest policy */},
    "owner": {/* owner policy */}
  }
}

Response:
{
  "success": true,
  "loaded_at": "2025-11-11T15:30:45Z",
  "version": "v123"
}
```

**Get Pipeline Health:**
```http
GET http://orchestrator:8002/health
Authorization: Bearer {service_api_key}

Response:
{
  "status": "healthy",
  "version": "1.0.0",
  "uptime_seconds": 86400,
  "services": {
    "gateway": "ok",
    "langgraph": "ok",
    "rag_connectors": "ok",
    "validators": "ok"
  },
  "models_loaded": ["llama-3.1-8b", "phi-3-mini"],
  "last_request": "2025-11-11T15:29:00Z"
}
```

**Query Request Trace:**
```http
GET http://orchestrator:8002/traces/{trace_id}
Authorization: Bearer {service_api_key}

Response:
{
  "trace_id": "req_xyz789",
  "timestamp": "2025-11-11T15:25:00Z",
  "mode": "guest",
  "room": "kitchen",
  "query": "what's the weather tomorrow",
  "stages": [
    {"name": "stt", "duration_ms": 650, "status": "ok"},
    {"name": "classify", "duration_ms": 120, "status": "ok", "intent": "info"},
    {"name": "retrieve", "duration_ms": 450, "status": "ok", "sources": 3},
    {"name": "synthesize", "duration_ms": 800, "status": "ok", "model": "llama-3.1-8b"},
    {"name": "validate", "duration_ms": 200, "status": "ok", "confidence": 0.92},
    {"name": "tts", "duration_ms": 680, "status": "ok"}
  ],
  "total_duration_ms": 2900,
  "success": true
}
```

---

### Home Assistant Integration

**Admin UI → HA:**

**Discover Entities:**
```http
GET https://192.168.10.168:8123/api/states
Authorization: Bearer {ha_long_lived_token}

Response: [/* array of all entities with state and attributes */]
```

**Test Entity Action:**
```http
POST https://192.168.10.168:8123/api/services/light/turn_on
Authorization: Bearer {ha_long_lived_token}
Content-Type: application/json

{
  "entity_id": "light.living_room",
  "brightness": 200
}
```

**Get Scene List:**
```http
GET https://192.168.10.168:8123/api/states?filter=scene.*
Authorization: Bearer {ha_long_lived_token}
```

---

### RAG Connectors Integration

**Admin UI → RAG Connectors:**

**Update Source Config:**
```http
PUT http://rag-connectors:8003/sources/weather/config
Authorization: Bearer {service_api_key}
Content-Type: application/json

{
  "enabled": true,
  "api_key_ref": "secret/athena/rag/weather",
  "cache_ttl_hours": 48,
  "rate_limit_per_minute": 60
}
```

**Invalidate Cache:**
```http
POST http://rag-connectors:8003/cache/invalidate
Authorization: Bearer {service_api_key}
Content-Type: application/json

{
  "sources": ["weather", "news"]
}
```

**Test Source:**
```http
POST http://rag-connectors:8003/sources/weather/test
Authorization: Bearer {service_api_key}

Response:
{
  "success": true,
  "latency_ms": 250,
  "sample_data": {/* sample weather response */}
}
```

---

### Prometheus/Grafana Integration

**Admin UI → Prometheus:**

**Query Metrics:**
```http
GET http://prometheus:9090/api/v1/query?query=athena_request_duration_seconds_bucket
Authorization: Bearer {readonly_token}

Response: {/* PromQL query result */}
```

**Admin UI → Grafana:**

**Get Dashboard JSON:**
```http
GET http://grafana:3000/api/dashboards/uid/{dashboard_uid}
Authorization: Bearer {grafana_service_account_token}

Response: {/* dashboard JSON */}
```

**Embed Dashboard Panel:**
```html
<iframe
  src="https://grafana.xmojo.net/d-solo/{dashboard_uid}/{panel_id}?orgId=1&theme=dark&panelId=2"
  width="100%"
  height="400"
  frameborder="0"
></iframe>
```

---

## 9) Packaging & Open-Source Release

### Repository Layout

```
athena-admin/
├── frontend/                # Next.js application
│   ├── app/                 # App Router (Next.js 14+)
│   │   ├── dashboard/       # Dashboard page
│   │   ├── policies/        # Modes & Policies page
│   │   ├── devices/         # Voice & Devices page
│   │   ├── ha/              # Home Assistant page
│   │   ├── rag/             # Knowledge & RAG page
│   │   ├── validation/      # Validation page
│   │   ├── notifications/   # Notifications page
│   │   ├── observability/   # Observability page
│   │   ├── security/        # Security & Secrets page
│   │   └── config/          # Packaging & Export page
│   ├── components/          # Reusable React components
│   ├── lib/                 # API clients, utilities
│   ├── public/              # Static assets
│   └── package.json
│
├── backend/                 # FastAPI application
│   ├── app/
│   │   ├── api/             # API routes
│   │   │   ├── dashboard.py
│   │   │   ├── policies.py
│   │   │   ├── devices.py
│   │   │   ├── ha.py
│   │   │   ├── rag.py
│   │   │   ├── validation.py
│   │   │   ├── notifications.py
│   │   │   ├── observability.py
│   │   │   ├── security.py
│   │   │   └── config.py
│   │   ├── models/          # Pydantic models
│   │   ├── services/        # Business logic
│   │   ├── auth/            # OIDC, RBAC
│   │   ├── db/              # Database models, migrations
│   │   └── main.py          # FastAPI app entry
│   ├── alembic/             # Database migrations
│   ├── tests/               # Backend tests
│   └── requirements.txt
│
├── docker/
│   ├── Dockerfile.frontend  # Next.js build
│   ├── Dockerfile.backend   # FastAPI app
│   └── Dockerfile.combined  # Single image (optional)
│
├── k8s/                     # Kubernetes manifests (optional)
│
├── compose/
│   ├── docker-compose.yml   # Development
│   └── docker-compose.prod.yml  # Production
│
├── docs/
│   ├── README.md
│   ├── SETUP.md             # Installation guide
│   ├── OIDC.md              # OIDC configuration
│   ├── RBAC.md              # Role definitions
│   ├── API.md               # API documentation
│   ├── CONFIG_REFERENCE.md  # Config file schema
│   ├── OPERATIONS.md        # Operational procedures
│   └── BACKUP_RECOVERY.md   # Disaster recovery
│
├── scripts/
│   ├── bootstrap.sh         # Initial setup
│   ├── seed_db.py           # Seed database with defaults
│   └── rotate_keys.sh       # Rotate service API keys
│
├── .env.example             # Environment template
├── role_mapping.yaml        # OIDC group to role mapping
├── LICENSE
└── README.md
```

### Deployment Options

**Option A: Single Docker Image**
- Next.js built as static export
- FastAPI serves static files + API
- Smaller footprint, simpler deployment

**Option B: Two Services**
- Next.js container (Node server) + FastAPI container
- More flexible, better for scaling
- Recommended for production

### Docker Compose (Production)

```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  admin-db:
    image: postgres:15
    environment:
      POSTGRES_DB: athena_admin
      POSTGRES_USER: athena_admin
      POSTGRES_PASSWORD: ${ADMIN_DB_PASSWORD}
    volumes:
      - admin-db-data:/var/lib/postgresql/data
    networks:
      - athena-internal

  admin-redis:
    image: redis:7-alpine
    networks:
      - athena-internal

  admin-backend:
    image: athena-admin-backend:latest
    environment:
      DATABASE_URL: postgresql://athena_admin:${ADMIN_DB_PASSWORD}@admin-db:5432/athena_admin
      REDIS_URL: redis://admin-redis:6379
      OIDC_PROVIDER_URL: ${OIDC_PROVIDER_URL}
      OIDC_CLIENT_ID: ${OIDC_CLIENT_ID}
      OIDC_CLIENT_SECRET: ${OIDC_CLIENT_SECRET}
      SECRETS_PROVIDER: ${SECRETS_PROVIDER}  # "sops" or "vault"
      SOPS_KEY_PATH: /run/secrets/sops_key
      VAULT_URL: ${VAULT_URL}
      VAULT_TOKEN: ${VAULT_TOKEN}
      SERVICE_API_KEY: ${SERVICE_API_KEY}
    secrets:
      - sops_key
    volumes:
      - ./role_mapping.yaml:/app/role_mapping.yaml:ro
    networks:
      - athena-internal
    depends_on:
      - admin-db
      - admin-redis

  admin-frontend:
    image: athena-admin-frontend:latest
    environment:
      NEXT_PUBLIC_API_URL: http://admin-backend:8000
    networks:
      - athena-internal
    depends_on:
      - admin-backend

  admin-proxy:
    image: traefik:v2.10
    command:
      - "--providers.docker=true"
      - "--entrypoints.web.address=:80"
      - "--entrypoints.websecure.address=:443"
      - "--certificatesresolvers.letsencrypt.acme.httpchallenge=true"
      - "--certificatesresolvers.letsencrypt.acme.httpchallenge.entrypoint=web"
      - "--certificatesresolvers.letsencrypt.acme.email=${ACME_EMAIL}"
      - "--certificatesresolvers.letsencrypt.acme.storage=/letsencrypt/acme.json"
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./letsencrypt:/letsencrypt
    labels:
      - "traefik.http.routers.admin.rule=Host(`admin.athena.xmojo.net`)"
      - "traefik.http.routers.admin.entrypoints=websecure"
      - "traefik.http.routers.admin.tls.certresolver=letsencrypt"
      - "traefik.http.services.admin.loadbalancer.server.port=3000"
    networks:
      - athena-internal

networks:
  athena-internal:
    external: true

volumes:
  admin-db-data:

secrets:
  sops_key:
    file: ./secrets/sops_key
```

### Open-Source Preset Generator

**Purpose:** Strip private data for public release

**Process:**
1. User clicks "Generate OSS Preset" button
2. Frontend sends `POST /api/config/generate-oss`
3. Backend:
   - Loads current config
   - Replaces Baltimore address with placeholder: "123 Sample St, Sample City, ST 12345"
   - Replaces all API keys with placeholders: `YOUR_API_KEY_HERE`
   - Replaces Airbnb calendar URL with: `YOUR_ICAL_URL_HERE`
   - Includes sample bookings (fake dates/names)
   - Includes sample devices (generic names/IPs)
   - Generates README with setup instructions
4. Returns ZIP file: `athena-config-oss.zip`
   - `config/security_modes.yaml` (sanitized)
   - `config/property_sample.yaml` (placeholder)
   - `config/models.yaml` (default models)
   - `config/rag_sources.yaml` (all sources, no keys)
   - `.env.example` (all variables with placeholders)
   - `README.md` (setup guide)

---

## 10) Version 1 Scope vs Future Enhancements

### ✅ V1 Scope (Ship It)

**Core Features:**
- ✅ Dashboard with mode indicator, health, metrics, recent requests
- ✅ Guest/Owner policy editor (form + YAML, dry-run, apply, rollback)
- ✅ Wake word toggles, device registry, room mapping
- ✅ HA connection, entity discovery, test actions
- ✅ RAG source toggles, airport set, region context, API key management
- ✅ Validation rules (anti-hallucination, cross-model, thresholds)
- ✅ Twilio/SMTP config, share templates, rate limits, test buttons
- ✅ Request explorer with filters, trace viewer
- ✅ Feedback queue with review, bulk actions, nightly report status
- ✅ OIDC auth, RBAC (4 roles), session management
- ✅ Secrets management (SOPS or Vault), never display after save
- ✅ Audit logs (tamper-evident, filterable)
- ✅ Export/import config (SOPS-encrypted)
- ✅ Snapshots with versioning, diff, rollback
- ✅ Manual override (guest mode toggle, PIN)
- ✅ Purge guest data button
- ✅ Embedded Grafana panels
- ✅ Safe-apply workflow (validate → backup → apply → health check → auto-rollback)

**Documentation:**
- ✅ Setup guide (Docker Compose, OIDC config)
- ✅ API documentation (OpenAPI spec)
- ✅ RBAC guide (role definitions, permission matrix)
- ✅ Config reference (YAML schema, examples)
- ✅ Operations runbook (backup, restore, disaster recovery)

**Testing:**
- ✅ Unit tests (backend logic, API routes)
- ✅ Integration tests (auth flow, policy apply, service communication)
- ✅ E2E tests (full workflow: edit policy → dry-run → apply → verify)

---

### 🔮 V1.1+ Future Enhancements

**Testing & Validation:**
- Synthetic test suites (pre-defined queries with expected outcomes)
- Scheduled test runs (cron-like: run all tests nightly)
- Regression detection (compare new answers against baseline)

**Advanced Automation:**
- Scene/automation designer (visual editor for multi-step sequences)
- A/B model testing (compare outputs from different models)
- Automated model picker (choose best model based on query type)

**Multi-Property Support:**
- Namespace configs by property (property A vs property B)
- Per-property booking calendars
- Property-specific RAG sources and contexts

**Fine-Grained Permissions:**
- Per-room guest policy variations (different rules per room)
- Time-based policy overrides (e.g., stricter rules after 10 PM)
- Guest-specific overrides (e.g., VIP guests get more access)

**Performance Tuning:**
- Per-category rate limit tuning UI (adjust rate limits per source)
- Cache warming (pre-fetch popular queries on schedule)
- Model preloading scheduler (load/unload models by demand)

**Advanced Analytics:**
- Natural language query patterns (word clouds, common phrases)
- Guest behavior analytics (anonymized: query types, peak times)
- Model performance comparisons (accuracy, latency by model)

**Integrations:**
- PMS webhook configuration UI (Hostaway, Guesty, Hospitable)
- Calendar sync with Google Calendar / Outlook (for owner blocking)
- Slack/Discord notifications (alert on system issues)

---

## 11) Deliverables for Implementation

### What Needs to Be Built

**Backend (FastAPI):**
1. ✅ OIDC authentication flow with session management
2. ✅ RBAC middleware (role-based access control)
3. ✅ All API endpoints (see Section 3 for complete list)
4. ✅ Database models and migrations (Alembic)
5. ✅ Service clients (Mode Service, Orchestrator, HA, RAG, Prometheus)
6. ✅ Safe-apply workflow with health checks and rollback
7. ✅ Secrets integration (SOPS and Vault adapters)
8. ✅ Audit logging with HMAC signatures
9. ✅ Rate limiting (Redis-based)
10. ✅ WebSocket/SSE for real-time updates (optional for V1)

**Frontend (Next.js):**
1. ✅ All 10 pages (Dashboard, Policies, Devices, HA, RAG, Validation, Notifications, Observability, Security, Config)
2. ✅ Reusable components (tables, forms, modals, cards, charts)
3. ✅ API client with auth (fetch wrapper with session cookie + CSRF)
4. ✅ Real-time updates (WebSocket client or polling)
5. ✅ YAML editor with syntax highlighting and live preview
6. ✅ Diff viewer (side-by-side JSON/YAML diff)
7. ✅ Grafana panel embeds (iframe with service account token)
8. ✅ Loading states, error handling, toast notifications

**Docker & Deployment:**
1. ✅ Dockerfile.backend (FastAPI + dependencies)
2. ✅ Dockerfile.frontend (Next.js build)
3. ✅ docker-compose.yml (development)
4. ✅ docker-compose.prod.yml (production with Traefik, PostgreSQL, Redis)
5. ✅ Alembic migrations (create tables on first run)
6. ✅ Seed script (default policies, admin user)

**Documentation:**
1. ✅ README.md (project overview, quick start)
2. ✅ SETUP.md (detailed installation, OIDC config)
3. ✅ OIDC.md (provider setup: Authentik, Keycloak)
4. ✅ RBAC.md (role definitions, permission matrix)
5. ✅ API.md (OpenAPI spec + examples)
6. ✅ CONFIG_REFERENCE.md (YAML schema, all options)
7. ✅ OPERATIONS.md (backup, restore, scaling, monitoring)
8. ✅ BACKUP_RECOVERY.md (disaster recovery procedures)

**Testing:**
1. ✅ Backend unit tests (pytest, 80%+ coverage)
2. ✅ Frontend unit tests (Jest, React Testing Library)
3. ✅ Integration tests (auth, policy apply, service communication)
4. ✅ E2E tests (Playwright: full workflow from edit to verify)

---

## 12) Success Criteria

### V1 Complete When:

**Functional:**
- [ ] User can log in via OIDC (Authentik/Keycloak)
- [ ] User roles enforced (Owner, Operator, Viewer, Support)
- [ ] Dashboard displays live metrics and health
- [ ] Policy editor allows editing guest/owner policies
- [ ] Dry-run validates policy without applying
- [ ] Apply triggers safe-apply workflow with auto-rollback on failure
- [ ] Rollback restores previous configuration
- [ ] Device registry auto-discovers HA Voice devices
- [ ] Device tests (mic, speaker) work
- [ ] HA entity discovery works, test actions execute
- [ ] RAG sources can be enabled/disabled
- [ ] API keys can be added, tested (without revealing value after save)
- [ ] Validation rules configurable (thresholds, cross-model)
- [ ] Twilio/SMTP config works, test messages send
- [ ] Request explorer shows requests with filters
- [ ] Trace viewer displays full request timeline
- [ ] Feedback queue allows review and retesting
- [ ] Audit logs display all configuration changes
- [ ] Export/import config works (SOPS-encrypted)
- [ ] Snapshots can be created, restored, downloaded
- [ ] Guest data purge button works (Owner only)
- [ ] Manual mode override works (with PIN for owner mode)

**Performance:**
- [ ] Dashboard loads < 1s
- [ ] Policy apply completes < 10s (including health checks)
- [ ] Request explorer query < 500ms
- [ ] Trace viewer loads < 1s
- [ ] API response times: read < 100ms, write < 500ms

**Security:**
- [ ] OIDC auth works, no local accounts
- [ ] CSRF protection enabled, tokens validated
- [ ] Secrets never displayed after save
- [ ] Audit logs tamper-evident (HMAC signatures verified)
- [ ] Rate limits enforced (429 returned when exceeded)
- [ ] RBAC enforced (403 returned for insufficient permissions)

**Documentation:**
- [ ] README explains project purpose and quick start
- [ ] SETUP.md provides step-by-step installation
- [ ] OIDC.md covers Authentik and Keycloak setup
- [ ] API.md includes OpenAPI spec + examples
- [ ] CONFIG_REFERENCE.md documents all YAML options
- [ ] OPERATIONS.md covers backup, restore, scaling

**Testing:**
- [ ] Backend unit tests pass (80%+ coverage)
- [ ] Frontend unit tests pass (70%+ coverage)
- [ ] Integration tests pass (auth, policy, services)
- [ ] E2E test passes (full workflow: edit → apply → verify)

---

## 13) Implementation Timeline Estimate

**Assumptions:**
- 2 developers (1 backend, 1 frontend)
- 6-8 hours/day productive time
- Iterative development with weekly demos

**Phase 1: Foundation (Week 1-2)**
- Backend: OIDC auth, RBAC, database setup
- Frontend: Auth flow, layout, navigation
- Docker: Development compose file
- **Deliverable:** Login works, dashboard skeleton

**Phase 2: Core Config (Week 3-4)**
- Backend: Policy CRUD, dry-run, apply/rollback
- Frontend: Policy editor (form + YAML), diff viewer
- Integration: Mode Service, Orchestrator clients
- **Deliverable:** Policy editing works end-to-end

**Phase 3: Device & HA (Week 5)**
- Backend: Device registry, HA integration
- Frontend: Devices page, HA page
- **Deliverable:** Device management and HA testing works

**Phase 4: RAG & Validation (Week 6)**
- Backend: RAG config, secrets, validation rules
- Frontend: RAG page, Validation page
- **Deliverable:** RAG sources and validation configurable

**Phase 5: Notifications & Observability (Week 7)**
- Backend: Twilio/SMTP, request explorer, feedback
- Frontend: Notifications page, Observability page
- **Deliverable:** Notifications and request tracing work

**Phase 6: Security & Config (Week 8)**
- Backend: Audit logs, export/import, snapshots
- Frontend: Security page, Config page
- **Deliverable:** Full audit trail and config management

**Phase 7: Polish & Testing (Week 9-10)**
- Backend: Unit tests, integration tests, performance tuning
- Frontend: E2E tests, UI polish, error handling
- Docker: Production compose file, deployment docs
- **Deliverable:** All tests pass, production-ready

**Total: 10 weeks (2.5 months)**

**Parallel Work Opportunities:**
- Frontend and backend can be built simultaneously (API-first design)
- Documentation can be written alongside code
- Testing can start in Week 5 (early phases)

**Realistic Timeline with Buffer: 12 weeks (3 months)**

---

## Conclusion

This specification provides a complete, implementable design for the **Admin Interface** - a comprehensive real-time configuration and monitoring website for Project Athena.

**Key Strengths:**
- ✅ **Comprehensive:** Covers all aspects of system configuration and monitoring
- ✅ **Secure:** OIDC + RBAC + secrets management + audit logging
- ✅ **Safe:** Dry-run validation + safe-apply + auto-rollback
- ✅ **User-Friendly:** Form + YAML editors, live preview, clear error messages
- ✅ **Observable:** Embedded metrics, request tracing, feedback management
- ✅ **Scalable:** Modular architecture, service-to-service communication
- ✅ **Documented:** Complete API spec, setup guides, operational procedures

**Integration Points:**
- Mode Service (guest/owner mode)
- Orchestrator (policy updates, health checks)
- Home Assistant (entity discovery, test actions)
- RAG Connectors (API keys, cache management)
- Prometheus/Grafana (embedded metrics)
- Notification services (Twilio, SMTP)

**Next Steps:**
1. Review and approve specification
2. Prioritize V1 features
3. Begin Phase 1 implementation (Foundation)
4. Iterate with weekly demos
5. Deploy to production after Phase 7

The admin interface will serve as the **central nervous system** for Project Athena, making it easy to configure, monitor, and operate the entire voice assistant system with confidence and safety.
